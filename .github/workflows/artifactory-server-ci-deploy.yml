name: Build and Push to Docker

on:
  push:
    branches:
      - dev
      - master

jobs:

  create_image:
    name: Create and push image to docker hub
    runs-on: ubuntu-latest
    env:
      DOCKER_REPO_HOME_SYSTEM_ARTIFACTORY: zaytsevdv/home-system-artifactory
    steps:
      - uses: actions/checkout@v1
      - name: Set up JDK 8
        uses: actions/setup-java@v1
        with:
          java-version: 8

      - name: Clean install MAVEN
        run: mvn -B clean install

      - name: Artifactory push
        run: mvn deploy -Dartifactory.user=${{ secrets.ARTIFACTORY_USER }} -Dartifactory.password=${{ secrets.ARTIFACTORY_PASSWORD }} -Dbuildnumber=1 -s settings.xml

